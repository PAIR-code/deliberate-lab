{
  "title": "Deliberate Lab API Schemas",
  "description": "JSON Schema definitions for Deliberate Lab API request types",
  "$defs": {
    "Stock": {
      "title": "Stock",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "name",
        "description",
        "csvData",
        "parsedData",
        "customCards"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "csvData": {
          "type": "string"
        },
        "parsedData": {
          "type": "array",
          "items": {
            "additionalProperties": false,
            "type": "object",
            "required": ["date", "close"],
            "properties": {
              "date": {
                "minLength": 1,
                "type": "string"
              },
              "close": {
                "type": "number"
              }
            },
            "title": "ParsedItem"
          }
        },
        "customCards": {
          "type": "array",
          "items": {
            "additionalProperties": false,
            "type": "object",
            "required": ["id", "title", "value", "subtext", "enabled"],
            "properties": {
              "id": {
                "minLength": 1,
                "type": "string"
              },
              "title": {
                "type": "string"
              },
              "value": {
                "type": "string"
              },
              "subtext": {
                "type": "string"
              },
              "enabled": {
                "type": "boolean"
              }
            },
            "title": "CustomCard"
          }
        }
      }
    },
    "ChatStageConfig": {
      "title": "ChatStageConfig",
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "timeLimitInMinutes",
        "requireFullTime"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "kind": {
          "const": "chat",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "timeLimitInMinutes": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ]
        },
        "requireFullTime": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ]
        }
      }
    },
    "ChipStageConfig": {
      "title": "ChipStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "enableChat",
        "numRounds",
        "chips"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "kind": {
          "const": "chip",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "enableChat": {
          "type": "boolean"
        },
        "numRounds": {
          "type": "number"
        },
        "chips": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ChipItem"
          }
        }
      }
    },
    "ChipItem": {
      "title": "ChipItem",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "name",
        "avatar",
        "canBuy",
        "canSell",
        "startingQuantity",
        "lowerValue",
        "upperValue"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "avatar": {
          "type": "string"
        },
        "canBuy": {
          "type": "boolean"
        },
        "canSell": {
          "type": "boolean"
        },
        "startingQuantity": {
          "type": "number"
        },
        "lowerValue": {
          "type": "number"
        },
        "upperValue": {
          "type": "number"
        }
      }
    },
    "MultipleChoiceItem": {
      "title": "MultipleChoiceItem",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "imageId", "text"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "imageId": {
          "type": "string"
        },
        "text": {
          "type": "string"
        }
      }
    },
    "FlipCardStageConfig": {
      "title": "FlipCardStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "cards",
        "enableSelection",
        "allowMultipleSelections",
        "requireConfirmation",
        "minUniqueCardsFlippedRequirement",
        "shuffleCards"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "flipcard",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "cards": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/FlipCard"
          }
        },
        "enableSelection": {
          "type": "boolean"
        },
        "allowMultipleSelections": {
          "type": "boolean"
        },
        "requireConfirmation": {
          "type": "boolean"
        },
        "minUniqueCardsFlippedRequirement": {
          "type": "number"
        },
        "shuffleCards": {
          "type": "boolean"
        }
      }
    },
    "FlipCard": {
      "title": "FlipCard",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "title", "frontContent", "backContent"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "frontContent": {
          "minLength": 1,
          "type": "string"
        },
        "backContent": {
          "minLength": 1,
          "type": "string"
        }
      }
    },
    "InfoStageConfig": {
      "title": "InfoStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "infoLines"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "info",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "infoLines": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "youtubeVideoId": {
          "type": "string"
        }
      }
    },
    "PayoutStageConfig": {
      "additionalProperties": false,
      "title": "PayoutStageConfig",
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "currency",
        "payoutItems",
        "averageAllPayoutItems"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "payout",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "currency": {
          "anyOf": [
            {
              "const": "EUR",
              "type": "string"
            },
            {
              "const": "GBP",
              "type": "string"
            },
            {
              "const": "USD",
              "type": "string"
            }
          ]
        },
        "payoutItems": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/DefaultPayoutItem"
              },
              {
                "$ref": "#/$defs/ChipPayoutItem"
              },
              {
                "$ref": "#/$defs/SurveyPayoutItem"
              }
            ]
          }
        },
        "averageAllPayoutItems": {
          "type": "boolean"
        }
      }
    },
    "DefaultPayoutItem": {
      "additionalProperties": false,
      "title": "DefaultPayoutItem",
      "type": "object",
      "required": [
        "id",
        "type",
        "name",
        "description",
        "isActive",
        "stageId",
        "baseCurrencyAmount",
        "randomSelectionId"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "const": "DEFAULT",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "isActive": {
          "type": "boolean"
        },
        "stageId": {
          "type": "string"
        },
        "baseCurrencyAmount": {
          "type": "number"
        },
        "randomSelectionId": {
          "type": "string"
        }
      }
    },
    "ChipPayoutItem": {
      "additionalProperties": false,
      "title": "ChipPayoutItem",
      "type": "object",
      "required": [
        "id",
        "type",
        "name",
        "description",
        "isActive",
        "stageId",
        "baseCurrencyAmount"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "const": "CHIP",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "isActive": {
          "type": "boolean"
        },
        "stageId": {
          "type": "string"
        },
        "baseCurrencyAmount": {
          "type": "number"
        }
      }
    },
    "SurveyPayoutItem": {
      "additionalProperties": false,
      "title": "SurveyPayoutItem",
      "type": "object",
      "required": [
        "id",
        "type",
        "name",
        "description",
        "isActive",
        "stageId",
        "baseCurrencyAmount",
        "rankingStageId",
        "questionMap"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "const": "SURVEY",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "isActive": {
          "type": "boolean"
        },
        "stageId": {
          "type": "string"
        },
        "baseCurrencyAmount": {
          "type": "number"
        },
        "rankingStageId": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "type": "string"
            }
          ]
        },
        "questionMap": {
          "type": "object",
          "patternProperties": {
            "^(.*)$": {
              "anyOf": [
                {
                  "type": "number"
                },
                {
                  "type": "null"
                }
              ]
            }
          },
          "title": "QuestionMap"
        }
      }
    },
    "RankingStageConfig": {
      "title": "RankingStageConfig",
      "anyOf": [
        {
          "$ref": "#/$defs/ItemRankingStageConfig"
        },
        {
          "$ref": "#/$defs/ParticipantRankingStageConfig"
        }
      ]
    },
    "ItemRankingStageConfig": {
      "title": "ItemRankingStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "rankingType",
        "strategy",
        "rankingItems"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "ranking",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "rankingType": {
          "const": "items",
          "type": "string"
        },
        "strategy": {
          "anyOf": [
            {
              "const": "none",
              "type": "string"
            },
            {
              "const": "condorcet",
              "type": "string"
            }
          ]
        },
        "rankingItems": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/RankingItem"
          }
        }
      }
    },
    "RankingItem": {
      "title": "RankingItem",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "imageId", "text"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "imageId": {
          "type": "string"
        },
        "text": {
          "type": "string"
        }
      }
    },
    "ParticipantRankingStageConfig": {
      "title": "ParticipantRankingStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "rankingType",
        "strategy",
        "enableSelfVoting"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "ranking",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "rankingType": {
          "const": "participants",
          "type": "string"
        },
        "strategy": {
          "anyOf": [
            {
              "const": "none",
              "type": "string"
            },
            {
              "const": "condorcet",
              "type": "string"
            }
          ]
        },
        "enableSelfVoting": {
          "type": "boolean"
        }
      }
    },
    "SurveyPerParticipantStageConfig": {
      "title": "SurveyPerParticipantStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "questions",
        "enableSelfSurvey"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "surveyPerParticipant",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "questions": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/TextSurveyQuestion"
              },
              {
                "$ref": "#/$defs/CheckSurveyQuestion"
              },
              {
                "$ref": "#/$defs/MultipleChoiceSurveyQuestion"
              },
              {
                "$ref": "#/$defs/ScaleSurveyQuestion"
              }
            ]
          }
        },
        "enableSelfSurvey": {
          "type": "boolean"
        }
      }
    },
    "TextSurveyQuestion": {
      "title": "TextSurveyQuestion",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "kind", "questionTitle"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "text",
          "type": "string"
        },
        "questionTitle": {
          "type": "string"
        },
        "condition": {
          "title": "Condition",
          "anyOf": [
            {
              "$ref": "#/$defs/ComparisonCondition"
            },
            {
              "$ref": "#/$defs/ConditionGroup"
            }
          ]
        },
        "minCharCount": {
          "type": "number"
        },
        "maxCharCount": {
          "type": "number"
        }
      }
    },
    "Condition": {
      "title": "Condition",
      "anyOf": [
        {
          "$ref": "#/$defs/ComparisonCondition"
        },
        {
          "$ref": "#/$defs/ConditionGroup"
        }
      ]
    },
    "ComparisonCondition": {
      "title": "ComparisonCondition",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "type", "target", "operator", "value"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "const": "comparison",
          "type": "string"
        },
        "target": {
          "$ref": "#/$defs/ConditionTargetReference"
        },
        "operator": {
          "title": "ComparisonOperator",
          "anyOf": [
            {
              "const": "equals",
              "type": "string"
            },
            {
              "const": "not_equals",
              "type": "string"
            },
            {
              "const": "greater_than",
              "type": "string"
            },
            {
              "const": "greater_than_or_equal",
              "type": "string"
            },
            {
              "const": "less_than",
              "type": "string"
            },
            {
              "const": "less_than_or_equal",
              "type": "string"
            },
            {
              "const": "contains",
              "type": "string"
            },
            {
              "const": "not_contains",
              "type": "string"
            }
          ]
        },
        "value": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "number"
            },
            {
              "type": "boolean"
            }
          ]
        }
      }
    },
    "ConditionTargetReference": {
      "title": "ConditionTargetReference",
      "additionalProperties": false,
      "type": "object",
      "required": ["stageId", "questionId"],
      "properties": {
        "stageId": {
          "minLength": 1,
          "type": "string"
        },
        "questionId": {
          "minLength": 1,
          "type": "string"
        }
      }
    },
    "ComparisonOperator": {
      "title": "ComparisonOperator",
      "anyOf": [
        {
          "const": "equals",
          "type": "string"
        },
        {
          "const": "not_equals",
          "type": "string"
        },
        {
          "const": "greater_than",
          "type": "string"
        },
        {
          "const": "greater_than_or_equal",
          "type": "string"
        },
        {
          "const": "less_than",
          "type": "string"
        },
        {
          "const": "less_than_or_equal",
          "type": "string"
        },
        {
          "const": "contains",
          "type": "string"
        },
        {
          "const": "not_contains",
          "type": "string"
        }
      ]
    },
    "ConditionGroup": {
      "title": "ConditionGroup",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "type", "operator", "conditions"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "const": "group",
          "type": "string"
        },
        "operator": {
          "title": "ConditionOperator",
          "anyOf": [
            {
              "const": "and",
              "type": "string"
            },
            {
              "const": "or",
              "type": "string"
            }
          ]
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Condition"
          }
        }
      }
    },
    "ConditionOperator": {
      "title": "ConditionOperator",
      "anyOf": [
        {
          "const": "and",
          "type": "string"
        },
        {
          "const": "or",
          "type": "string"
        }
      ]
    },
    "CheckSurveyQuestion": {
      "title": "CheckSurveyQuestion",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "kind", "questionTitle", "isRequired"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "check",
          "type": "string"
        },
        "questionTitle": {
          "type": "string"
        },
        "isRequired": {
          "type": "boolean"
        },
        "condition": {
          "title": "Condition",
          "anyOf": [
            {
              "$ref": "#/$defs/ComparisonCondition"
            },
            {
              "$ref": "#/$defs/ConditionGroup"
            }
          ]
        }
      }
    },
    "MultipleChoiceSurveyQuestion": {
      "title": "MultipleChoiceSurveyQuestion",
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "kind", "questionTitle", "options", "correctAnswerId"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "mc",
          "type": "string"
        },
        "questionTitle": {
          "type": "string"
        },
        "options": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/MultipleChoiceItem"
          }
        },
        "correctAnswerId": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "type": "string"
            }
          ]
        },
        "condition": {
          "title": "Condition",
          "anyOf": [
            {
              "$ref": "#/$defs/ComparisonCondition"
            },
            {
              "$ref": "#/$defs/ConditionGroup"
            }
          ]
        }
      }
    },
    "ScaleSurveyQuestion": {
      "title": "ScaleSurveyQuestion",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "questionTitle",
        "upperValue",
        "upperText",
        "lowerValue",
        "lowerText"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "scale",
          "type": "string"
        },
        "questionTitle": {
          "type": "string"
        },
        "upperValue": {
          "type": "number"
        },
        "upperText": {
          "type": "string"
        },
        "lowerValue": {
          "type": "number"
        },
        "lowerText": {
          "type": "string"
        },
        "middleText": {
          "type": "string"
        },
        "useSlider": {
          "type": "boolean"
        },
        "stepSize": {
          "minimum": 1,
          "type": "number"
        },
        "condition": {
          "title": "Condition",
          "anyOf": [
            {
              "$ref": "#/$defs/ComparisonCondition"
            },
            {
              "$ref": "#/$defs/ConditionGroup"
            }
          ]
        }
      }
    },
    "SurveyStageConfig": {
      "title": "SurveyStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "questions"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "survey",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "questions": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/TextSurveyQuestion"
              },
              {
                "$ref": "#/$defs/CheckSurveyQuestion"
              },
              {
                "$ref": "#/$defs/MultipleChoiceSurveyQuestion"
              },
              {
                "$ref": "#/$defs/ScaleSurveyQuestion"
              }
            ]
          }
        }
      }
    },
    "CohortParticipantConfig": {
      "title": "CohortParticipantConfig",
      "type": "object",
      "required": [
        "minParticipantsPerCohort",
        "maxParticipantsPerCohort",
        "includeAllParticipantsInCohortCount",
        "botProtection"
      ],
      "properties": {
        "minParticipantsPerCohort": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "minimum": 0,
              "type": "number"
            }
          ]
        },
        "maxParticipantsPerCohort": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "minimum": 1,
              "type": "number"
            }
          ]
        },
        "includeAllParticipantsInCohortCount": {
          "type": "boolean"
        },
        "botProtection": {
          "type": "boolean"
        }
      }
    },
    "StaticVariableConfig": {
      "title": "StaticVariableConfig",
      "type": "object",
      "required": ["id", "type", "scope", "definition", "value"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "default": "static",
          "const": "static",
          "type": "string"
        },
        "scope": {
          "anyOf": [
            {
              "const": "experiment",
              "type": "string"
            },
            {
              "const": "cohort",
              "type": "string"
            },
            {
              "const": "participant",
              "type": "string"
            }
          ]
        },
        "definition": {
          "$ref": "#/$defs/VariableDefinition"
        },
        "value": {
          "type": "string"
        }
      }
    },
    "VariableDefinition": {
      "title": "VariableDefinition",
      "additionalProperties": false,
      "type": "object",
      "required": ["name", "description", "schema"],
      "properties": {
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "schema": {
          "title": "JSONSchemaDefinition",
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {
                  "const": "string",
                  "type": "string"
                }
              },
              "title": "String"
            },
            {
              "additionalProperties": true,
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {
                  "const": "number",
                  "type": "string"
                }
              },
              "title": "Number"
            },
            {
              "additionalProperties": true,
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {
                  "const": "integer",
                  "type": "string"
                }
              },
              "title": "Integer"
            },
            {
              "additionalProperties": true,
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {
                  "const": "boolean",
                  "type": "string"
                }
              },
              "title": "Boolean"
            },
            {
              "additionalProperties": true,
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {
                  "const": "object",
                  "type": "string"
                },
                "properties": {
                  "type": "object",
                  "patternProperties": {
                    "^(.*)$": {
                      "$ref": "#/$defs/JSONSchemaDefinition"
                    }
                  },
                  "title": "Properties"
                }
              },
              "title": "Object"
            },
            {
              "additionalProperties": true,
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {
                  "const": "array",
                  "type": "string"
                },
                "items": {
                  "$ref": "#/$defs/JSONSchemaDefinition"
                }
              },
              "title": "Array"
            }
          ]
        }
      }
    },
    "JSONSchemaDefinition": {
      "title": "JSONSchemaDefinition",
      "anyOf": [
        {
          "additionalProperties": true,
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "const": "string",
              "type": "string"
            }
          },
          "title": "String"
        },
        {
          "additionalProperties": true,
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "const": "number",
              "type": "string"
            }
          },
          "title": "Number"
        },
        {
          "additionalProperties": true,
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "const": "integer",
              "type": "string"
            }
          },
          "title": "Integer"
        },
        {
          "additionalProperties": true,
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "const": "boolean",
              "type": "string"
            }
          },
          "title": "Boolean"
        },
        {
          "additionalProperties": true,
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "const": "object",
              "type": "string"
            },
            "properties": {
              "type": "object",
              "patternProperties": {
                "^(.*)$": {
                  "$ref": "#/$defs/JSONSchemaDefinition"
                }
              },
              "title": "Properties"
            }
          },
          "title": "Object"
        },
        {
          "additionalProperties": true,
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "const": "array",
              "type": "string"
            },
            "items": {
              "$ref": "#/$defs/JSONSchemaDefinition"
            }
          },
          "title": "Array"
        }
      ]
    },
    "RandomPermutationVariableConfig": {
      "title": "RandomPermutationVariableConfig",
      "type": "object",
      "required": [
        "id",
        "type",
        "scope",
        "definition",
        "shuffleConfig",
        "values"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "default": "random_permutation",
          "const": "random_permutation",
          "type": "string"
        },
        "scope": {
          "anyOf": [
            {
              "const": "experiment",
              "type": "string"
            },
            {
              "const": "cohort",
              "type": "string"
            },
            {
              "const": "participant",
              "type": "string"
            }
          ]
        },
        "definition": {
          "$ref": "#/$defs/VariableDefinition"
        },
        "shuffleConfig": {
          "additionalProperties": false,
          "type": "object",
          "required": ["shuffle", "seed", "customSeed"],
          "properties": {
            "shuffle": {
              "type": "boolean"
            },
            "seed": {
              "anyOf": [
                {
                  "const": "experiment",
                  "type": "string"
                },
                {
                  "const": "cohort",
                  "type": "string"
                },
                {
                  "const": "participant",
                  "type": "string"
                },
                {
                  "const": "custom",
                  "type": "string"
                }
              ]
            },
            "customSeed": {
              "type": "string"
            }
          },
          "title": "ShuffleConfig"
        },
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "numToSelect": {
          "minimum": 1,
          "type": "number"
        },
        "expandListToSeparateVariables": {
          "type": "boolean"
        }
      }
    },
    "BalancedAssignmentVariableConfig": {
      "title": "BalancedAssignmentVariableConfig",
      "type": "object",
      "required": [
        "id",
        "type",
        "scope",
        "definition",
        "values",
        "balanceStrategy",
        "balanceAcross"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "type": {
          "default": "balanced_assignment",
          "const": "balanced_assignment",
          "type": "string"
        },
        "scope": {
          "anyOf": [
            {
              "const": "experiment",
              "type": "string"
            },
            {
              "const": "cohort",
              "type": "string"
            },
            {
              "const": "participant",
              "type": "string"
            }
          ]
        },
        "definition": {
          "$ref": "#/$defs/VariableDefinition"
        },
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "weights": {
          "type": "array",
          "items": {
            "minimum": 1,
            "type": "number"
          }
        },
        "balanceStrategy": {
          "anyOf": [
            {
              "const": "round_robin",
              "type": "string"
            },
            {
              "const": "random",
              "type": "string"
            }
          ]
        },
        "balanceAcross": {
          "anyOf": [
            {
              "const": "experiment",
              "type": "string"
            },
            {
              "const": "cohort",
              "type": "string"
            }
          ]
        }
      }
    },
    "AgentMediatorTemplate": {
      "title": "AgentMediatorTemplate",
      "type": "object",
      "required": ["persona", "promptMap"],
      "properties": {
        "persona": {
          "type": "object",
          "required": ["id", "name"],
          "properties": {
            "id": {
              "minLength": 1,
              "type": "string"
            },
            "name": {
              "type": "string"
            }
          },
          "title": "Persona"
        },
        "promptMap": {
          "type": "object",
          "patternProperties": {
            "^(.*)$": {
              "type": "object",
              "properties": {},
              "title": "^(.*)$"
            }
          },
          "title": "PromptMap"
        }
      }
    },
    "AgentParticipantTemplate": {
      "title": "AgentParticipantTemplate",
      "type": "object",
      "required": ["persona", "promptMap"],
      "properties": {
        "persona": {
          "type": "object",
          "required": ["id", "name"],
          "properties": {
            "id": {
              "minLength": 1,
              "type": "string"
            },
            "name": {
              "type": "string"
            }
          },
          "title": "Persona"
        },
        "promptMap": {
          "type": "object",
          "patternProperties": {
            "^(.*)$": {
              "type": "object",
              "properties": {},
              "title": "^(.*)$"
            }
          },
          "title": "PromptMap"
        }
      }
    },
    "AssetAllocationStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "stockConfig"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "assetAllocation",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "stockConfig": {
          "additionalProperties": false,
          "type": "object",
          "required": ["stockA", "stockB"],
          "properties": {
            "stockInfoStageId": {
              "minLength": 1,
              "type": "string"
            },
            "stockA": {
              "$ref": "#/$defs/Stock"
            },
            "stockB": {
              "$ref": "#/$defs/Stock"
            }
          },
          "title": "StockConfig"
        }
      },
      "title": "AssetAllocationStageConfig"
    },
    "MultiAssetAllocationStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "stockOptions",
        "stockInfoStageId"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "multiAssetAllocation",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "stockOptions": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Stock"
          }
        },
        "stockInfoStageId": {
          "type": "string"
        }
      },
      "title": "MultiAssetAllocationStageConfig"
    },
    "ComprehensionStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "questions"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "comprehension",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "questions": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "additionalProperties": false,
                "type": "object",
                "required": ["id", "kind", "questionTitle", "correctAnswer"],
                "properties": {
                  "id": {
                    "minLength": 1,
                    "type": "string"
                  },
                  "kind": {
                    "const": "text",
                    "type": "string"
                  },
                  "questionTitle": {
                    "type": "string"
                  },
                  "correctAnswer": {
                    "type": "string"
                  }
                },
                "title": "TextQuestion"
              },
              {
                "additionalProperties": false,
                "type": "object",
                "required": [
                  "id",
                  "kind",
                  "questionTitle",
                  "options",
                  "correctAnswerId"
                ],
                "properties": {
                  "id": {
                    "minLength": 1,
                    "type": "string"
                  },
                  "kind": {
                    "const": "mc",
                    "type": "string"
                  },
                  "questionTitle": {
                    "type": "string"
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "$ref": "#/$defs/MultipleChoiceItem"
                    }
                  },
                  "correctAnswerId": {
                    "type": "string"
                  }
                },
                "title": "McQuestion"
              }
            ]
          }
        }
      },
      "title": "ComprehensionStageConfig"
    },
    "FlipcardStageConfig": {
      "title": "FlipCardStageConfig",
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "cards",
        "enableSelection",
        "allowMultipleSelections",
        "requireConfirmation",
        "minUniqueCardsFlippedRequirement",
        "shuffleCards"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "flipcard",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "cards": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/FlipCard"
          }
        },
        "enableSelection": {
          "type": "boolean"
        },
        "allowMultipleSelections": {
          "type": "boolean"
        },
        "requireConfirmation": {
          "type": "boolean"
        },
        "minUniqueCardsFlippedRequirement": {
          "type": "number"
        },
        "shuffleCards": {
          "type": "boolean"
        }
      }
    },
    "PrivateChatStageConfig": {
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "timeLimitInMinutes"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "kind": {
          "const": "privateChat",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "timeLimitInMinutes": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ]
        },
        "requireFullTime": {
          "type": "boolean"
        },
        "isTurnBasedChat": {
          "type": "boolean"
        },
        "minNumberOfTurns": {
          "type": "number"
        },
        "maxNumberOfTurns": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ]
        }
      },
      "title": "PrivateChatStageConfig"
    },
    "ProfileStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "profileType"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "profile",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "profileType": {
          "anyOf": [
            {
              "const": "DEFAULT",
              "type": "string"
            },
            {
              "const": "DEFAULT_GENDERED",
              "type": "string"
            },
            {
              "const": "ANONYMOUS_ANIMAL",
              "type": "string"
            },
            {
              "const": "ANONYMOUS_PARTICIPANT",
              "type": "string"
            }
          ]
        }
      },
      "title": "ProfileStageConfig"
    },
    "RevealStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "kind", "name", "descriptions", "progress", "items"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "reveal",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "items": {
          "type": "array",
          "items": {
            "0": {
              "$ref": "#/$defs/RevealStageConfig"
            },
            "1": {
              "$ref": "#/$defs/SurveyStageConfig"
            }
          }
        }
      },
      "title": "RevealStageConfig"
    },
    "RoleStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": ["id", "kind", "name", "descriptions", "progress", "roles"],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "role",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "roles": {
          "type": "array",
          "items": {
            "additionalProperties": false,
            "type": "object",
            "required": [
              "id",
              "name",
              "displayLines",
              "minParticipants",
              "maxParticipants"
            ],
            "properties": {
              "id": {
                "minLength": 1,
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "displayLines": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "minParticipants": {
                "type": "number"
              },
              "maxParticipants": {
                "anyOf": [
                  {
                    "type": "number"
                  },
                  {
                    "type": "null"
                  }
                ]
              }
            },
            "title": "Role"
          }
        }
      },
      "title": "RoleStageConfig"
    },
    "SalespersonStageConfig": {
      "type": "object",
      "required": ["id", "kind", "name", "descriptions", "progress"],
      "properties": {
        "id": {
          "type": "string"
        },
        "kind": {
          "const": "salesperson",
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        }
      },
      "title": "SalespersonStageConfig"
    },
    "StockinfoStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "stocks",
        "showBestYearCard",
        "showWorstYearCard"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "stockinfo",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "stocks": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Stock"
          }
        },
        "showBestYearCard": {
          "type": "boolean"
        },
        "showWorstYearCard": {
          "type": "boolean"
        },
        "introText": {
          "type": "string"
        }
      },
      "title": "StockinfoStageConfig"
    },
    "TosStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "tosLines"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "tos",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "tosLines": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "title": "TosStageConfig"
    },
    "TransferStageConfig": {
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id",
        "kind",
        "name",
        "descriptions",
        "progress",
        "enableTimeout",
        "timeoutSeconds"
      ],
      "properties": {
        "id": {
          "minLength": 1,
          "type": "string"
        },
        "kind": {
          "const": "transfer",
          "type": "string"
        },
        "name": {
          "minLength": 1,
          "type": "string"
        },
        "descriptions": {
          "$ref": "#/$defs/StageTextConfig"
        },
        "progress": {
          "$ref": "#/$defs/StageProgressConfig"
        },
        "enableTimeout": {
          "type": "boolean"
        },
        "timeoutSeconds": {
          "type": "number"
        }
      },
      "title": "TransferStageConfig"
    }
  },
  "type": "object",
  "required": ["stage", "experimentCreation", "cohortCreation", "cohortUpdate"],
  "properties": {
    "stage": {
      "anyOf": [
        {
          "$ref": "#/$defs/AssetAllocationStageConfig"
        },
        {
          "$ref": "#/$defs/MultiAssetAllocationStageConfig"
        },
        {
          "$ref": "#/$defs/ChatStageConfig"
        },
        {
          "$ref": "#/$defs/ChipStageConfig"
        },
        {
          "$ref": "#/$defs/ComprehensionStageConfig"
        },
        {
          "$ref": "#/$defs/FlipCardStageConfig"
        },
        {
          "$ref": "#/$defs/InfoStageConfig"
        },
        {
          "$ref": "#/$defs/PayoutStageConfig"
        },
        {
          "$ref": "#/$defs/PrivateChatStageConfig"
        },
        {
          "$ref": "#/$defs/ProfileStageConfig"
        },
        {
          "title": "RankingStageConfig",
          "anyOf": [
            {
              "$ref": "#/$defs/ItemRankingStageConfig"
            },
            {
              "$ref": "#/$defs/ParticipantRankingStageConfig"
            }
          ]
        },
        {
          "$ref": "#/$defs/RevealStageConfig"
        },
        {
          "$ref": "#/$defs/RoleStageConfig"
        },
        {
          "$ref": "#/$defs/SalespersonStageConfig"
        },
        {
          "$ref": "#/$defs/StockinfoStageConfig"
        },
        {
          "$ref": "#/$defs/SurveyPerParticipantStageConfig"
        },
        {
          "$ref": "#/$defs/SurveyStageConfig"
        },
        {
          "$ref": "#/$defs/TosStageConfig"
        },
        {
          "$ref": "#/$defs/TransferStageConfig"
        }
      ]
    },
    "experimentCreation": {
      "additionalProperties": false,
      "type": "object",
      "required": ["collectionName", "experimentTemplate"],
      "properties": {
        "collectionName": {
          "anyOf": [
            {
              "const": "experimentTemplates",
              "type": "string"
            },
            {
              "const": "experiments",
              "type": "string"
            }
          ]
        },
        "experimentTemplate": {
          "type": "object",
          "required": [
            "id",
            "experiment",
            "stageConfigs",
            "agentMediators",
            "agentParticipants"
          ],
          "properties": {
            "id": {
              "type": "string"
            },
            "experiment": {
              "additionalProperties": false,
              "type": "object",
              "required": [
                "id",
                "versionId",
                "metadata",
                "permissions",
                "defaultCohortConfig",
                "prolificConfig",
                "stageIds",
                "cohortLockMap"
              ],
              "properties": {
                "id": {
                  "type": "string"
                },
                "versionId": {
                  "type": "number"
                },
                "metadata": {
                  "type": "object",
                  "required": ["name", "publicName", "description", "tags"],
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "publicName": {
                      "type": "string"
                    },
                    "description": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "title": "Metadata"
                },
                "permissions": {
                  "type": "object",
                  "required": ["visibility", "readers"],
                  "properties": {
                    "visibility": {
                      "anyOf": [
                        {
                          "const": "public",
                          "type": "string"
                        },
                        {
                          "const": "private",
                          "type": "string"
                        }
                      ]
                    },
                    "readers": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "title": "Permissions"
                },
                "defaultCohortConfig": {
                  "$ref": "#/$defs/CohortParticipantConfig"
                },
                "prolificConfig": {
                  "type": "object",
                  "required": [
                    "enableProlificIntegration",
                    "defaultRedirectCode",
                    "attentionFailRedirectCode",
                    "bootedRedirectCode"
                  ],
                  "properties": {
                    "enableProlificIntegration": {
                      "type": "boolean"
                    },
                    "defaultRedirectCode": {
                      "type": "string"
                    },
                    "attentionFailRedirectCode": {
                      "type": "string"
                    },
                    "bootedRedirectCode": {
                      "type": "string"
                    }
                  },
                  "title": "ProlificConfig"
                },
                "stageIds": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "cohortLockMap": {
                  "type": "object",
                  "patternProperties": {
                    "^(.*)$": {
                      "type": "boolean"
                    }
                  },
                  "title": "CohortLockMap"
                },
                "variableConfigs": {
                  "type": "array",
                  "items": {
                    "anyOf": [
                      {
                        "$ref": "#/$defs/StaticVariableConfig"
                      },
                      {
                        "$ref": "#/$defs/RandomPermutationVariableConfig"
                      },
                      {
                        "$ref": "#/$defs/BalancedAssignmentVariableConfig"
                      }
                    ]
                  }
                },
                "variableMap": {
                  "type": "object",
                  "patternProperties": {
                    "^(.*)$": {
                      "type": "string"
                    }
                  },
                  "title": "VariableMap"
                }
              },
              "title": "Experiment"
            },
            "stageConfigs": {
              "type": "array",
              "items": {
                "anyOf": [
                  {
                    "$ref": "#/$defs/AssetAllocationStageConfig"
                  },
                  {
                    "$ref": "#/$defs/MultiAssetAllocationStageConfig"
                  },
                  {
                    "$ref": "#/$defs/ChatStageConfig"
                  },
                  {
                    "$ref": "#/$defs/ChipStageConfig"
                  },
                  {
                    "$ref": "#/$defs/ComprehensionStageConfig"
                  },
                  {
                    "$ref": "#/$defs/FlipCardStageConfig"
                  },
                  {
                    "$ref": "#/$defs/InfoStageConfig"
                  },
                  {
                    "$ref": "#/$defs/PayoutStageConfig"
                  },
                  {
                    "$ref": "#/$defs/PrivateChatStageConfig"
                  },
                  {
                    "$ref": "#/$defs/ProfileStageConfig"
                  },
                  {
                    "title": "RankingStageConfig",
                    "anyOf": [
                      {
                        "$ref": "#/$defs/ItemRankingStageConfig"
                      },
                      {
                        "$ref": "#/$defs/ParticipantRankingStageConfig"
                      }
                    ]
                  },
                  {
                    "$ref": "#/$defs/RevealStageConfig"
                  },
                  {
                    "$ref": "#/$defs/RoleStageConfig"
                  },
                  {
                    "$ref": "#/$defs/SalespersonStageConfig"
                  },
                  {
                    "$ref": "#/$defs/StockinfoStageConfig"
                  },
                  {
                    "$ref": "#/$defs/SurveyPerParticipantStageConfig"
                  },
                  {
                    "$ref": "#/$defs/SurveyStageConfig"
                  },
                  {
                    "$ref": "#/$defs/TosStageConfig"
                  },
                  {
                    "$ref": "#/$defs/TransferStageConfig"
                  }
                ]
              }
            },
            "agentMediators": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/AgentMediatorTemplate"
              }
            },
            "agentParticipants": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/AgentParticipantTemplate"
              }
            }
          },
          "title": "ExperimentTemplate"
        }
      },
      "title": "ExperimentCreation"
    },
    "cohortCreation": {
      "additionalProperties": false,
      "type": "object",
      "required": ["experimentId", "cohortConfig"],
      "properties": {
        "experimentId": {
          "minLength": 1,
          "type": "string"
        },
        "cohortConfig": {
          "additionalProperties": false,
          "type": "object",
          "required": ["id", "metadata", "participantConfig", "stageUnlockMap"],
          "properties": {
            "id": {
              "type": "string"
            },
            "metadata": {
              "type": "object",
              "required": ["name", "publicName", "description", "tags"],
              "properties": {
                "name": {
                  "type": "string"
                },
                "publicName": {
                  "type": "string"
                },
                "description": {
                  "type": "string"
                },
                "tags": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "title": "Metadata"
            },
            "participantConfig": {
              "$ref": "#/$defs/CohortParticipantConfig"
            },
            "stageUnlockMap": {
              "type": "object",
              "patternProperties": {
                "^(.*)$": {
                  "type": "boolean"
                }
              },
              "title": "StageUnlockMap"
            },
            "variableMap": {
              "type": "object",
              "patternProperties": {
                "^(.*)$": {
                  "type": "string"
                }
              },
              "title": "VariableMap"
            }
          },
          "title": "CohortConfig"
        }
      },
      "title": "CohortCreation"
    },
    "cohortUpdate": {
      "additionalProperties": false,
      "type": "object",
      "required": ["experimentId", "cohortId", "metadata", "participantConfig"],
      "properties": {
        "experimentId": {
          "minLength": 1,
          "type": "string"
        },
        "cohortId": {
          "minLength": 1,
          "type": "string"
        },
        "metadata": {
          "type": "object",
          "required": ["name", "publicName", "description", "tags"],
          "properties": {
            "name": {
              "type": "string"
            },
            "publicName": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "title": "Metadata"
        },
        "participantConfig": {
          "$ref": "#/$defs/CohortParticipantConfig"
        }
      },
      "title": "CohortUpdate"
    }
  },
  "$id": "DeliberateLabSchemas"
}
